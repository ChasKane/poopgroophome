<!DOCTYPE html>
<html>
    <head>
            <title>TI Innovation Lab</title>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
    
            <!--meep get styls and stuff from bootstrap //Load first, so that any changes to style are done after this load//-->
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
      
            <script src="../../js/lab/laserqueue.js"></script>
            <script src="../../js/common.js"></script>
    </head>

    <style>
        .Waiting {
            background-color: #ffad99;
        }
        .Cutting {
            background-color: #ffffcc;
        }
        .Skipped {
            background-color: #d6d6c2;
        }
        .Done {
            background-color: #80ff80;
        }

        .custom-container {
            padding-left: 260px;
            padding-right: 50px;
        }

        #toplabel{
                  display: block;
                  font-size: 1.6em;
                  margin-top: .8em;
                  margin-bottom: 1em;
                  margin-left: 0;
                  margin-right: 0;
              }
    </style>

    <body>

        <div id="display" class="col-sm-2" content-include-html="This is where the other HTML conent is displayed"></div>

        <div class="custom-container">

            <div class="container-fluid col-sm-12 lineup">
                <ul id="nav_tab" class="nav nav-tabs">
                    <li class="active"><a data-toggle="tab" href="#home">Laser Appt</a></li>
                    <li><a data-toggle="tab" href="#menu1">Laser Queue</a></li>
                    <li><a data-toggle="tab" href="#menu2">Laser Config</a></li>
                    <li><a data-toggle="tab" href="#menu3">Laser Cam</a></li>
                </ul>
                
                <div class="tab-content">
                    <div id="home" class="tab-pane fade in active">
                        <div id="meep" class="well b-color-3">

                            <div id="toplabel">
                                <p> Laser Cutting Appointments  <p>
                                <hr> 
                            </div>

                            <div>
                    
                                <body id="TableBody" >
                    
                    
                                    <div id="3DPrintTableDiv" >
                                        
                                        <button type="button" class = "btn btn-default btn-sm">Add Apptionment </button><br>
                    
                                        <div>
                                            <br>
                                            <button type="button" class = "btn btn-default btn-sm" id="fillTableButton" class="buttons" onclick="fillTable();"> Update Schedule </button> 
                                        </div>
                                        <br></br>
                    
                                        <div class="container-fluid">
                                            <div class="table-responsive">
                                                <table class="table table-striped table-bordered table-condensed table-hover">
                    
                                                    <thead>
                                                        <tr>
                                                            <th>Name</th>
                                                            <th>Time</th>
                                                            <th>Options</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="tableBod">
                                                        <tr>
                                                            <td>derpington</td>
                                                            <td>12:00</td>
                                                            <td>
                                                                <!-- make buttons together -->
                                                                <div class="btn-group">
                                                                    <button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#contactView"><span class="glyphicon glyphicon-info-sign"></span> View</button>
                                                                    <button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#contactEdit"><span class="glyphicon glyphicon-pencil"></span> Edit</button>
                                                                    <button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#contactDelete"><span class="glyphicon glyphicon-trash"></span> Delete</button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>herpington</td>
                                                            <td>1:00</td>
                                                            <td>
                                                                <!-- make buttons together -->
                                                                <div class="btn-group">
                                                                    <button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#contactView"><span class="glyphicon glyphicon-info-sign"></span> View</button>
                                                                    <button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#contactEdit"><span class="glyphicon glyphicon-pencil"></span> Edit</button>
                                                                    <button type="button" class="btn btn-default btn-xs" data-toggle="modal" data-target="#contactDelete"><span class="glyphicon glyphicon-trash"></span> Delete</button>
                                                                </div>
                                                            </td>
                                                        </tr>
                    
                                                    </tbody>
                    
                    
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                               </body>
                            </div>
                        </div>
                    </div>
                    


                    <div id="menu1" class="tab-pane fade">
                        <body>
                            <div class="well b-color-3 container-fluid">
                            
                                    
                            <div id="toplabel">
                                <p> Laser Queue <p>
                                <hr> 
                            </div>
                            <div class="row content" vis="block" id="laser_cutting_queue">
                                    <form class="form-horizontal">
                                        <div class="from-group container-fluid">
                                            <label class="col-sm-1" for="tech_Select">Tech:</label>
                                            <div class="col-sm-4">
                                                <select class="form-control" id="tech_select">
                                                </select>
                                            </div>
                                        </div>
                                        <br>

                                        <div class="from-group container-fluid">
                                            <label class="col-sm-1 ">Student:</label>
                                            <div class="col-sm-4">
                                                  <input id="userCard_ID" class="form-control" placeholder="Search" type="text" onkeypress="return keyAccept(event, 'userCard_ID', cardSwipeFind);" autocomplete="off" autofocus>

                                                <ul class="dropdown-menu" id="dropdown"><!--Dropdown list-->
                                                
                                                </ul>
                                            </div>
                                            <button type="button" class="btn btn-default btn-sm col-sm-2" onclick="addLaserQueueButton();">Manualy Add Student</button>
                                        </div>
                                         <br>
                                        <button type="button" id="fillTableButton"  class="btn btn-default btn-sm"onclick="laserQueueButton();" style="margin-left:2%;"> Update Table </button>
                                         <br></br>
                                    </form>
                        
                                    <div id="contactTableDiv"> 
                                        
                                        <div class="container-fluid">
                                            <div class="table-responsive">
                                                <table class="table table-bordered table-condensed table-hover">
                                                    
                                                    <thead>
                                                        <tr>
                                                            
                                                            <th>Machine</th>
                                                            <th>Student Name</th>
                                                            <th>Tech Name</th> <!-- waiting cutting done skipped-->
                                                            <th>Estimated time</th> <!-- delete-->
                                                            <th>Status</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="tableBody">
                                                        
                                                    </tbody>
                                                    
                                                    
                                                </table>
                                            </div>
                                        </div>
                                    </div> 
                                </div>
                                <div id="manually_add_to_queue"  vis="none" student_id="" style="display: none;">
                                    <label for="name">Name</label>
                                    <input class="form-control" type="text" id="student_name" name="name" placeholder="Student name..">
                                    <br>
                                    <label for="estimated_time">Estimated Time (hh:mm)</label>
                                    <input class="form-control" type="text" id="estimated_time" name="estimated_time" placeholder="Estimated time format: 00:30 for 30 minutes">
                                    <br>
                                    <label>Lab Tech </label><span></span>
                                    <select class="form-control" id="tech_select_add"></select>   
                                    <br>
                                    <label>Machine ID</label><span></span>
                                    <select class="form-control" id="machine_id"></select> 
                                    <br>
                                    <button id="add_to_queue_button" onclick="addToLaserQueueButton()">Add to queue</button>
                                    <button onclick="laserQueueSwap('laser_cutting_queue')">Back</button>
                                </div>      
                            </div>
                        </body>

                    </div>

                    <div id="menu2" class="tab-pane fade">
                        <div class="well b-color-3">
                            <div id="config_table" vis="block">
                                                                    
                            <div id="toplabel">
                                <p> Laser Configurations and Settings <p>
                                <hr> 
                            </div>
                                <div>
                                    <button class="btn btn-default btn-sm" onclick="getLaserConfigs();">Update Config</button>
                                </div>
                                <br>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-condensed table-hover">
                                        
                                        <thead>
                                            <tr>
                                                <th>Material</th>
                                                <th>Type</th>
                                                <th>Thickness</th>
                                                <th>Power</th>
                                                <th>Speed</th> <!-- waiting cutting done skipped-->
                                                <th>PPI</th> <!-- delete-->
                                                <th>Notes</th>
                                                <th>Delete</th>
                                            </tr>
                                        </thead>
                                        <tbody id="configBody">
                                            
                                        </tbody>
                                        
                                    </table>
                                </div>
                                <button class="btn btn-default btn-sm" onclick="configSwap('add_config');">Add Config</button>
                            </div>
                            <div id="add_config" vis="none" style="display: none;">
                                <label>Material</label>
                                <input class="form-control" type="text" id="material" placeholder="Material name..">
                                <br>
                                <label>Task</label>
                                <input class="form-control" type="text" id="task" placeholder="Task: cut/engrave">
                                <br>
                                <label>Thickness</label><span></span>
                                <input class="form-control" id="thickness"></input>   
                                <br>
                                <label>Power</label><span></span>
                                <input class="form-control" id="power"></input> 
                                <br>
                                <label>Speed</label><span></span>
                                <input class="form-control" id="speed"></input> 
                                <br>
                                <label>PPI</label><span></span>
                                <input class="form-control" id="ppi"></input> 
                                <br>
                                <label>Notes</label><span></span>
                                <input class="form-control" id="notes"></input> 
                                <br>
                                <button onclick="addConfig()">Add Configuration</button>
                                <button onclick="configSwap('config_table')">Back</button>
                            </div>
                        </div>
                    </div>
                    <div id="menu3" class="tab-pane fade">
                            <div class="well b-color-3">
                                                                    
                            <div id="toplabel">
                                <p> Live Laser Cut <p>
                                <hr> 
                            </div>
                                <div class="well b-color-3">
                                    [Insert Cam Feed HERE]
                                </div>
                            </div>
                    </div>
                </div>
                <!--<button type="button" class="btn btn-default btn-sm" onclick="modPop('insertArg');" data-toggle="modal" data-target="#modalPop">TEST</button>-->
            </div>
        </div>
    </body>

     <!--Modal pop up, just leave it here-->
    <div class="modal fade" id="searchStudentModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title">Search</h2>
                </div>
                <div id="searchDB" align="center" class="modal-body">
                    <form 0>
                        <label for="fname">First Name </label>
                        <input class="form-control" type="text" id="student_search" autofocus name="firstname" placeholder="Your name.." onkeyup="return fillModalTable('student_search');">
                        <br>
                    </form>
                
                    <table class="table table-bordered table-condensed table-hover">
                        <thead>
                            <tr>
                                <td>Student Name</td>
                            </tr>
                        </thead>
                        <tbody id="student_table" style="min-height: 31px">
                            
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button id="addStudentClose" type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    

    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.5.6/firebase-messaging.js"></script>
    <script>

        var sessId, baseUrl = "http://104.248.113.22", objRequest, dbReqParam, xmlHRequest, tObjs, tIds;

        /*function that includes html*/
        function includeHTML(arg)
        {
            var z, i, elmnt, file, xhttp, id;
            file = arg

            /*loop thru html elements*/
            z = document.getElementsByTagName("*");

            for (i = 0; i < z.length; i++) 
            {
                elmnt = z[i];

                if (elmnt.getAttribute("content-include-html") == "This is where the other HTML conent is displayed")
                {
                    /*make http req*/
                    xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function()
                    {
                        if (this.readyState == 4)
                        {
                            if (this.status == 200) {elmnt.innerHTML = this.responseText;}
                            if (this.status == 404) {elmnt.innerHTML = "ERR 404: page not found!";}
                            /*edit attrib, call again*/
                            elmnt.setAttribute("content-include-html", "nope");
                            includeHTML();
                            elmnt.setAttribute("content-include-html", "This is where the other HTML conent is displayed");
                        }
                    }
                    xhttp.open("GET", file, true);
                    xhttp.send();
                    
                    return;
                }
            }
        }

        // Pop up function for confirmations and alerts
        function modPop(arg)
        {
            var i, j;
        
            
            //  if (true)
            //  {
                    // document.getElementById("popViewTitle").innerHTML = "Hello There";
                    // document.getElementById("popViewBod").innerHTML = "<p></p>";
                    // document.getElementById("popBottomButt").innerHTML = "Close";
            //      return;
            //  }
        }

        $(document).ready(function() {
            $('.nav-tabs a').on('show.bs.tab', function(e){
                console.log(e.href);
                activeTab = $(this).attr('href').split('-')[1];        
                if(this.getAttribute('href') == "#menu1") {
                    console.log("clicked")
                    focusOn("userCard_ID")
                    //loadDropNow();
                }
            });
        });

        // wip
        function loadDropNow() {
            document.getElementById("dropdown").classList.toggle("show");
        }

        //Load on page load
        window.onload = function fistToLoad() {
            includeHTML('../../html/Menu_Bar.html');
            getLabTechs('tech_select'); 
            getLabTechs("tech_select_add");
            fillMachineID("machine_id");
            hashCheck("#menu1", laserQueueHash);
            laserQueueButton();
        }
    </script>
</html>